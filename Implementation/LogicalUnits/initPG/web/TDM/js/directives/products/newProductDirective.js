function newProductDirective(){return{restrict:"E",templateUrl:"views/products/newProduct.html",scope:{content:"="},controller:function($scope,TDMService,BreadCrumbsService,toastr,$timeout){var newProductCtrl=this;newProductCtrl.productData={product_versions:[]},newProductCtrl.addProduct=function(){if(_.find($scope.content.productData,{product_name:newProductCtrl.productData.product_name,product_status:"Active"}))return toastr.error("System # "+newProductCtrl.productData.product_name+" Already Exists");newProductCtrl.productData.product_versions=newProductCtrl.productData.product_versions.join(","),TDMService.createProduct(newProductCtrl.productData).then((function(response){"SUCCESS"==response.errorCode?(toastr.success("System # "+newProductCtrl.productData.product_name,"Created Successfully"),newProductCtrl.productData.product_id=response.result.id,$timeout((function(){$scope.content.openProduct(newProductCtrl.productData)}),300)):toastr.error("System # "+newProductCtrl.productData.product_name,"Unable to Create : "+response.message)}))},newProductCtrl.addVersion=function(newVersion){newVersion&&(newProductCtrl.productData.product_versions||(newProductCtrl.productData.product_versions=[]),newProductCtrl.productData.product_versions.indexOf(newVersion)>=0?newProductCtrl.addVersionError=!0:(newProductCtrl.productData.product_versions.push(newVersion),newProductCtrl.isOpen=!1))},newProductCtrl.initAddVersionPopup=function(){newProductCtrl.addVersionError=!1,newProductCtrl.versionToAdd="",newProductCtrl.isOpen=!0},BreadCrumbsService.push({},"NEW_PRODUCT",(function(){}))},controllerAs:"newProductCtrl"}}angular.module("TDM-FE").directive("newProductDirective",newProductDirective);