function postExecutionProcess(){return{restrict:"E",templateUrl:"js/components/postExecutionProcess/postExecutionProcess.html",scope:{data:"=",postExecutionProcess:"=",mode:"="},controller:function($scope,TDMService,AuthService,toastr,$timeout){var postExecutionProcessCtrl=this;postExecutionProcessCtrl.description=null,$scope.postExecutionProcess&&(postExecutionProcessCtrl.processName=$scope.postExecutionProcess.process_name,postExecutionProcessCtrl.executionOrder=$scope.postExecutionProcess.execution_order,postExecutionProcessCtrl.description=$scope.postExecutionProcess.process_description),TDMService.getGenericAPI(("post"===$scope.mode?"post":"pre")+"executionprocesses").then((function(response){postExecutionProcessCtrl.processNames=_.filter(Object.keys(response.result),processName=>!($scope.data&&$scope.data.postExecutionData&&_.findIndex($scope.data.postExecutionData,{process_name:processName})>=0)),$scope.postExecutionProcess&&(postExecutionProcessCtrl.processName=$scope.postExecutionProcess.process_name,postExecutionProcessCtrl.processNames.indexOf($scope.postExecutionProcess.process_name)<0&&postExecutionProcessCtrl.processNames.push($scope.postExecutionProcess.process_name))})).catch((function(err){$scope.postExecutionProcess&&(postExecutionProcessCtrl.processName=$scope.postExecutionProcess.process_name)})),postExecutionProcessCtrl.postExecutionProcessChange=function(){var dataToSend={process_id:$scope.postExecutionProcess?$scope.postExecutionProcess.process_id:void 0,process_name:postExecutionProcessCtrl.processName,execution_order:postExecutionProcessCtrl.executionOrder,process_description:postExecutionProcessCtrl.description,be_id:$scope.data.beId},apiToCall=TDMService.postExecutionProcess;"pre"===$scope.mode&&(apiToCall=TDMService.addPreExecutionProcess),$scope.postExecutionProcess&&(apiToCall=TDMService.putExecutionProcess,"pre"===$scope.mode&&(apiToCall=TDMService.putPreExecutionProcess)),apiToCall($scope.data.beId,$scope.data.beName,dataToSend).then((function(response){if("SUCCESS"==response.errorCode){if($scope.postExecutionProcess){var index=_.findIndex($scope.data.postExecutionData,{process_id:$scope.postExecutionProcess.process_id});index>=0&&($scope.data.postExecutionData[index]=dataToSend)}else{let temp=angular.copy(dataToSend);temp.process_id=response.result.id,$scope.data.postExecutionData.push(temp)}$scope.data.reloadData(),$scope.data.close(),toastr.success("Entity Group Query added successfully")}else response.message.indexOf('duplicate key value violates unique constraint "tdm_be_exe_process')>=0?postExecutionProcessCtrl.alert={type:"danger",msg:`Failed to add the ${"post"===$scope.mode?"Post":"Pre"} Execution Process. The ${dataToSend.process_name} is already defined for the Business Entity. Please set a different ${"post"===$scope.mode?"Post":"Pre"} Execution Process.`}:postExecutionProcessCtrl.alert={type:"danger",msg:"Failed to Add Post Execution Process ["+response.message+"]"}}))}},controllerAs:"postExecutionProcessCtrl"}}angular.module("TDM-FE").directive("postExecutionProcess",postExecutionProcess);