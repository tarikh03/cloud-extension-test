function queryBuilder($compile,$timeout){return{restrict:"E",scope:{group:"=",params:"=",disablechange:"=",lastindex:"=",form:"=",index:"="},templateUrl:"js/components/task/queryBuilder/queryBuilder.html",compile:function(element,attrs){var content,directive;return content=element.contents().remove(),function(scope,element,attrs){scope.operators=[{name:"AND"},{name:"OR"}],scope.conditions=[{name:"=",id:"="},{name:"<>",id:"<>"},{name:"<",id:">"},{name:"<=",id:">="},{name:">",id:"<"},{name:">=",id:"<="},{name:"Is null",id:"Is null"},{name:"Is not null",id:"Is not null"}],scope.comboConditions=[{name:"="},{name:"<>"},{name:"IN",id:"IN",multiple:!0},{name:"NOT IN",id:"NOT IN",multiple:!0},{name:"Is null",id:"Is null"},{name:"Is not null",id:"Is not null"}],scope.changeParam=function(rule,field){rule.data=void 0,scope.data=void 0;var param=_.find(scope.params,{param_name:field});param&&(rule.type=param.param_type,rule.table=param.table,rule.comboIndicator=param.COMBO_INDICATOR,"integer"!=rule.type&&"real"!=rule.type&&"number"!=rule.type||(rule.min=parseFloat(param.min_value),rule.max=parseFloat(param.max_value)),param.valid_values&&param.valid_values.length>0&&(rule.validValues=param.valid_values)),rule.field=field},scope.changeCondition=function(rule,condition){rule.condition=condition},scope.changeData=function(rule,data){rule.data=void 0!==data?data:void 0},scope.addCondition=function(){scope.group.rules.push({condition:"",field:"",data:void 0,operator:"AND"})},scope.disableIfNull=function(rule,condition){"Is null"===condition||"Is not null"===condition?(rule.disableThird=!0,rule.data=void 0):rule.disableThird=!1},scope.removeCondition=function(index){scope.group.rules.splice(index,1)},scope.addGroup=function(){scope.group.rules.push({group:{operator:"AND",rules:[]}})},scope.removeGroup=function(){"group"in scope.$parent&&scope.$parent.group.rules.splice(scope.$parent.$index,1)},directive||(directive=$compile(content)),element.append(directive(scope,(function($compile){return $compile})))}}}}angular.module("TDM-FE").directive("queryBuilder",["$compile",queryBuilder]);